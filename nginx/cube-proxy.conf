server {
    listen 80;

    # Proxy the Cube UI (served on cube-server:4000) while injecting a small branding overlay
    location / {
        proxy_pass http://cube-server:4000/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # Inject branding JS/CSS by rewriting the HTML response (simple approach)
        sub_filter_types text/html;
        sub_filter '<head>' '<head>\n    <link rel="stylesheet" href="/branding/style.css">\n    <script src="/branding/branding.js"></script>';
        sub_filter_once off;
        proxy_buffering off;
    }

    # Serve branding static files
    location /branding/ {
        alias /usr/share/nginx/html/branding/;
    }
}


